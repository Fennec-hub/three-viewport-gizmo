{"version":3,"file":"three-viewport-gizmo.umd.cjs","sources":["../lib/utils/getDomContainer.ts","../lib/utils/constants.ts","../lib/utils/getAxesLines.ts","../lib/utils/getDomElement.ts","../lib/utils/getBackgroundSphere.ts","../lib/utils/getSpriteMaterial.ts","../lib/utils/getAxesSpritePoints.ts","../lib/utils/prepareQuaternions.ts","../lib/utils/setRadius.ts","../lib/utils/prepareAnimationData.ts","../lib/utils/updateSpritesOpacity.ts","../lib/utils/isClick.ts","../lib/utils/resetSprites.ts","../lib/utils/updatePointer.ts","../lib/utils/getIntersectionObject.ts","../lib/utils/clamp.ts","../lib/ViewportGizmo.ts"],"sourcesContent":["import { DomPlacement, GizmoOptions } from \"../types\";\n\nexport const getDomContainer = (\n  placement: DomPlacement,\n  size: number,\n  offset: Required<GizmoOptions>[\"offset\"]\n) => {\n  const div = document.createElement(\"div\");\n  const style = div.style;\n\n  const { top, left, right, bottom } = offset;\n\n  style.height = `${size}px`;\n  style.width = `${size}px`;\n  style.borderRadius = \"100%\";\n  style.position = \"absolute\";\n  style.background = \"#fff3\";\n  style.opacity = \"0\";\n  style.zIndex = \"10000\";\n\n  const [y, x] = placement.split(\"-\");\n\n  style.transform = \"\";\n  style.margin = `${top}px ${right}px ${bottom}px ${left}px`;\n  style.left = x === \"left\" ? \"0\" : x === \"center\" ? `50%` : \"\";\n  style.right = x === \"right\" ? \"0\" : \"\";\n  style.transform += x === \"center\" ? \"translateX(-50%)\" : \"\";\n  style.top = y === \"top\" ? \"0\" : y === \"bottom\" ? \"\" : \"50%\";\n  style.bottom = y === \"bottom\" ? \"0\" : \"\";\n  style.transform += y === \"center\" ? \"translateY(-50%)\" : \"\";\n\n  return div;\n};\n","import { GizmoOptions } from \"@lib/types\";\nimport { Color } from \"three\";\n\nexport const GIZMO_AXES = [\"x\", \"y\", \"z\", \"nx\", \"ny\", \"nz\"] as const;\nexport const GIZMO_DEFAULT_OPTIONS: GizmoOptions = {\n  container: document.body,\n  placement: \"top-right\",\n  size: 128,\n  lineWidth: 3,\n  offset: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n  },\n  font: {\n    family: \"helvetica\",\n    weight: 900,\n  },\n  resolution: 64,\n  backgroundSphere: {\n    enabled: true,\n    color: 0xffffff,\n    opacity: 0.2,\n  },\n  x: {\n    text: \"X\",\n    colors: {\n      main: \"#ff3653\",\n    },\n  },\n  y: {\n    text: \"Y\",\n    colors: {\n      main: \"#8adb00\",\n    },\n  },\n  z: {\n    text: \"Z\",\n    colors: {\n      main: \"#2c8fff\",\n    },\n  },\n  nx: {\n    drawLine: false,\n    colors: {\n      main: \"#ff3653\",\n    },\n  },\n  ny: {\n    drawLine: false,\n    colors: {\n      main: \"#8adb00\",\n    },\n  },\n  nz: {\n    drawLine: false,\n    colors: {\n      main: \"#2c8fff\",\n    },\n  },\n};\nexport const COLOR_MANAGER = new Color();\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  LineBasicMaterial,\n  LineSegments,\n} from \"three\";\nimport { GizmoOptions } from \"../types\";\nimport { COLOR_MANAGER, GIZMO_AXES } from \"./constants\";\n\nexport const getAxesLines = (options: GizmoOptions) => {\n  const positions: number[] = [];\n  const colors: number[] = [];\n\n  GIZMO_AXES.forEach((key, i) => {\n    const axis = options[key]!;\n\n    if (axis.drawLine === false) return;\n\n    const negative = i < 3 ? 1 : -1;\n    const distance = i < 3 ? 0.9 : 1.025;\n\n    positions.push(\n      key.includes(\"x\") ? distance * negative : 0,\n      key.includes(\"y\") ? distance * negative : 0,\n      key.includes(\"z\") ? distance * negative : 0,\n      0,\n      0,\n      0\n    );\n\n    const main = axis.colors!.main!;\n    const [color1, color2] = Array.isArray(main) ? main : [main, main];\n    colors.push(\n      ...COLOR_MANAGER.set(color2).toArray(),\n      ...COLOR_MANAGER.set(color1).toArray()\n    );\n  });\n\n  const geometry = new BufferGeometry();\n  geometry.setAttribute(\n    \"position\",\n    new BufferAttribute(new Float32Array(positions), 3)\n  );\n  geometry.setAttribute(\n    \"color\",\n    new BufferAttribute(new Float32Array(colors), 3)\n  );\n\n  return new LineSegments(\n    geometry,\n    new LineBasicMaterial({\n      linewidth: options.lineWidth ?? 3,\n      vertexColors: true,\n    })\n  );\n};\n","export const getDomElement = (\n  domElement: string | HTMLElement\n): HTMLElement => {\n  const element =\n    typeof domElement === \"string\"\n      ? document.querySelector<HTMLElement>(domElement)\n      : domElement;\n\n  if (!element) throw Error(`Invalid DOM element`);\n\n  return element;\n};\n","import {\n  BackSide,\n  ColorRepresentation,\n  Mesh,\n  MeshBasicMaterial,\n  SphereGeometry,\n} from \"three\";\n\nexport function getBackgroundSphere(color: ColorRepresentation) {\n  const geometry = new SphereGeometry(1.6, 64, 64);\n  const sphere = new Mesh(\n    geometry,\n    new MeshBasicMaterial({\n      color,\n      side: BackSide,\n      transparent: true,\n      opacity: 0,\n      depthTest: false,\n    })\n  );\n\n  return sphere;\n}\n","import { GizmoOptions } from \"@lib/types\";\nimport {\n  CanvasTexture,\n  RepeatWrapping,\n  SRGBColorSpace,\n  SpriteMaterial,\n} from \"three\";\n\nexport function getSpriteMaterial(\n  font: Required<GizmoOptions>[\"font\"],\n  resolution: number,\n  color: string,\n  text: string | undefined,\n  textColor: string | null,\n  hover: string | null,\n  hoverText: string | null,\n  border?: boolean\n) {\n  const canvas = document.createElement(\"canvas\");\n  resolution = resolution ?? 64;\n\n  const offset = 0.02;\n\n  canvas.width = resolution * 2 + resolution * (offset * 4);\n  canvas.height = resolution + resolution * (offset * 2);\n\n  const radius = resolution / 2;\n  const centerY = resolution / 2 + resolution * offset;\n  const circle2X = centerY * 3;\n\n  const context = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n\n  drawCircle(context, radius, centerY, centerY, color, border);\n  drawCircle(context, radius, circle2X, centerY, hover || \"#FFF\", border);\n\n  if (text != null) {\n    const family = font.family || \"sans-serif\";\n    const weight = font.weight || 500;\n\n    const fixY = fitTextInBox(context, text, family, weight, resolution);\n\n    context.textAlign = \"center\";\n    context.textBaseline = \"middle\";\n    context.fillStyle = textColor || \"#000\";\n    context.fillText(text, centerY, centerY + fixY);\n    context.fillStyle = hoverText || textColor || \"#000\";\n    context.fillText(text, circle2X, centerY + fixY);\n  }\n\n  const texture = new CanvasTexture(canvas);\n  texture.colorSpace = SRGBColorSpace;\n  texture.wrapS = texture.wrapT = RepeatWrapping;\n  texture.repeat.x = 0.5;\n\n  return new SpriteMaterial({\n    map: texture,\n    toneMapped: false,\n    transparent: true,\n  });\n}\n\nfunction drawCircle(\n  context: CanvasRenderingContext2D,\n  radius: number,\n  x: number,\n  y: number,\n  color: string,\n  border: boolean = false\n) {\n  const borderSize = y * 0.1;\n  radius = border ? radius - borderSize : radius;\n\n  if (border) context.globalAlpha = 0.2;\n  context.beginPath();\n  context.arc(x, y, radius, 0, 2 * Math.PI);\n  context.closePath();\n  context.fillStyle = color;\n  context.fill();\n\n  if (border) {\n    context.globalAlpha = 1;\n    context.strokeStyle = color;\n    context.lineWidth = borderSize;\n    context.stroke();\n  }\n}\n\nfunction fitTextInBox(\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  font: string,\n  weight: string | number,\n  size: number\n) {\n  const square = Math.sqrt(Math.pow(size * 0.7, 2) / 2);\n  let fontSize = square;\n  let textWidth = 0;\n  let textHeight = 0;\n\n  do {\n    ctx.font = `${weight} ${fontSize}px ${font}`;\n    const measure = ctx.measureText(text);\n    textWidth = measure.width;\n    textHeight = measure.fontBoundingBoxDescent;\n    fontSize--;\n  } while (textWidth > square && fontSize > 0);\n\n  const scaleFactor = Math.min(square / textWidth, square / textHeight);\n\n  const finalFontSize = Math.floor(fontSize * scaleFactor);\n\n  ctx.font = `${weight} ${finalFontSize}px ${font}`;\n\n  return square / textHeight;\n}\n","import { Sprite } from \"three\";\nimport { getSpriteMaterial } from \"./getSpriteMaterial\";\nimport { GizmoOptions } from \"@lib/types\";\nimport { COLOR_MANAGER, GIZMO_AXES } from \"./constants\";\n\nexport function getAxesSpritePoints(options: GizmoOptions) {\n  const { font, resolution: spriteResolution } = options;\n\n  return GIZMO_AXES.map((key, i) => {\n    const { text, colors, border } = options[key]!;\n    const isPositive = i < 3;\n    const axis = (isPositive ? key : key[1]) as \"x\" | \"y\" | \"z\";\n\n    const { text: textColor, main, hover, hoverText } = colors!;\n    const color = Array.isArray(main) ? main[1] : main!;\n    const forceScale = border && text;\n\n    const sprite = new Sprite(\n      getSpriteMaterial(\n        font!,\n        spriteResolution!,\n        COLOR_MANAGER.set(color).getStyle(),\n        text,\n        (textColor && COLOR_MANAGER.set(textColor).getStyle()) || null,\n        (hover && COLOR_MANAGER.set(hover).getStyle()) || null,\n        (hoverText && COLOR_MANAGER.set(hoverText).getStyle()) || null,\n        border\n      )\n    );\n\n    sprite.userData.type = key;\n    sprite.userData.forceScale = forceScale;\n    sprite.scale.setScalar(forceScale || isPositive ? 0.6 : 0.4);\n    sprite.position[axis] = isPositive ? 1.2 : -1.2;\n    sprite.renderOrder = 1;\n\n    return sprite;\n  });\n}\n","import { Camera, Object3D, Vector3 } from \"three\";\nimport { targetPosition, q1, q2 } from \"../ViewportGizmo\";\n\nconst dummy = new Object3D();\n\nexport function prepareQuaternions(\n  camera: Camera,\n  radius: { value: number },\n  focusPoint: Vector3\n) {\n  targetPosition.multiplyScalar(radius.value).add(focusPoint);\n\n  dummy.position.copy(focusPoint);\n\n  dummy.lookAt(camera.position);\n  q1.copy(dummy.quaternion);\n\n  dummy.lookAt(targetPosition);\n  q2.copy(dummy.quaternion);\n}\n","import { Camera, Vector3 } from \"three\";\n\nexport function setRadius(\n  camera: Camera,\n  radius: {\n    value: number;\n  },\n  focusPoint: Vector3\n) {\n  radius.value = camera.position.distanceTo(focusPoint);\n}\n","import { Euler, OrthographicCamera, PerspectiveCamera, Vector3 } from \"three\";\nimport { targetPosition, targetQuaternion } from \"../ViewportGizmo\";\nimport { prepareQuaternions } from \"./prepareQuaternions\";\nimport { setRadius } from \"./setRadius\";\nimport { GIZMO_AXES } from \"./constants\";\n\nexport function prepareAnimationData(\n  camera: OrthographicCamera | PerspectiveCamera,\n  focusPoint: Vector3,\n  axis: (typeof GIZMO_AXES)[number],\n  radius: { value: number }\n) {\n  switch (axis) {\n    case \"x\":\n      targetPosition.set(1, 0, 0);\n      targetQuaternion.setFromEuler(new Euler(0, Math.PI * 0.5, 0));\n      break;\n\n    case \"y\":\n      targetPosition.set(0, 1, 0);\n      targetQuaternion.setFromEuler(new Euler(-Math.PI * 0.5, 0, 0));\n      break;\n\n    case \"z\":\n      targetPosition.set(0, 0, 1);\n      targetQuaternion.setFromEuler(new Euler());\n      break;\n\n    case \"nx\":\n      targetPosition.set(-1, 0, 0);\n      targetQuaternion.setFromEuler(new Euler(0, -Math.PI * 0.5, 0));\n      break;\n\n    case \"ny\":\n      targetPosition.set(0, -1, 0);\n      targetQuaternion.setFromEuler(new Euler(Math.PI * 0.5, 0, 0));\n      break;\n\n    case \"nz\":\n      targetPosition.set(0, 0, -1);\n      targetQuaternion.setFromEuler(new Euler(0, Math.PI, 0));\n      break;\n\n    default:\n      console.error(\"ViewHelper: Invalid axis.\");\n  }\n\n  setRadius(camera, radius, focusPoint);\n  prepareQuaternions(camera, radius, focusPoint);\n}\n","import { Camera, Sprite, Vector3 } from \"three\";\n\nconst enum Axes {\n  PositiveX,\n  PositiveY,\n  PositiveZ,\n  NegativeX,\n  NegativeY,\n  NegativeZ,\n}\n\nconst point = new Vector3();\n\nexport function updateSpritesOpacity(sprites: Sprite[], camera: Camera) {\n  point.set(0, 0, 1);\n  point.applyQuaternion(camera.quaternion);\n\n  if (point.x >= 0) {\n    sprites[Axes.PositiveX].material.opacity = 1;\n    sprites[Axes.NegativeX].material.opacity = 0.5;\n  } else {\n    sprites[Axes.PositiveX].material.opacity = 0.5;\n    sprites[Axes.NegativeX].material.opacity = 1;\n  }\n\n  if (point.y >= 0) {\n    sprites[Axes.PositiveY].material.opacity = 1;\n    sprites[Axes.NegativeY].material.opacity = 0.5;\n  } else {\n    sprites[Axes.PositiveY].material.opacity = 0.5;\n    sprites[Axes.NegativeY].material.opacity = 1;\n  }\n\n  if (point.z >= 0) {\n    sprites[Axes.PositiveZ].material.opacity = 1;\n    sprites[Axes.NegativeZ].material.opacity = 0.5;\n  } else {\n    sprites[Axes.PositiveZ].material.opacity = 0.5;\n    sprites[Axes.NegativeZ].material.opacity = 1;\n  }\n}\n","import { Vector2 } from \"three\";\n\nexport function isClick(\n  e: PointerEvent,\n  startCoords: Vector2,\n  threshold: number = 10\n) {\n  return (\n    Math.abs(e.clientX - startCoords.x) < threshold &&\n    Math.abs(e.clientY - startCoords.y) < threshold\n  );\n}\n","import { Sprite } from \"three\";\n\nexport function resetSprites(sprites: Sprite[]) {\n  let i = sprites.length;\n\n  while (i--) {\n    sprites[i].scale.setScalar(\n      i < 3 || sprites[i].userData.forceScale ? 0.6 : 0.4\n    );\n    sprites[i].material.map!.offset.x = 1;\n  }\n}\n","import { OrthographicCamera, Vector2 } from \"three\";\nimport { raycaster } from \"../ViewportGizmo\";\n\nconst mouse = new Vector2();\n\nexport function updatePointer(\n  e: PointerEvent,\n  domRect: DOMRect,\n  orthoCamera: OrthographicCamera\n) {\n  mouse.x = ((e.clientX - domRect.left) / domRect.width) * 2 - 1;\n  mouse.y = -((e.clientY - domRect.top) / domRect.height) * 2 + 1;\n\n  raycaster.setFromCamera(mouse, orthoCamera);\n}\n","import { OrthographicCamera, Sprite } from \"three\";\nimport { updatePointer } from \"./updatePointer\";\nimport { raycaster } from \"../ViewportGizmo\";\n\nexport function getIntersectionObject(\n  event: PointerEvent,\n  domRect: DOMRect,\n  orthoCamera: OrthographicCamera,\n  intersectionObjects: Sprite[]\n) {\n  updatePointer(event, domRect, orthoCamera);\n\n  const intersects = raycaster.intersectObjects(intersectionObjects);\n\n  if (!intersects.length) return null;\n\n  const intersection = intersects[0];\n  return intersection.object as Sprite;\n}\n","export function clamp(num: number, min: number, max: number) {\n  return Math.min(Math.max(num, min), max);\n}\n","import {\n  Clock,\n  Euler,\n  Material,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  OrthographicCamera,\n  PerspectiveCamera,\n  Quaternion,\n  Raycaster,\n  Sprite,\n  Vector2,\n  Vector3,\n  Vector4,\n  WebGLRenderer,\n} from \"three\";\n\nimport { getDomContainer } from \"./utils/getDomContainer\";\nimport { getAxesLines } from \"./utils/getAxesLines\";\nimport { getDomElement } from \"./utils/getDomElement\";\nimport { getBackgroundSphere } from \"./utils/getBackgroundSphere\";\nimport { getAxesSpritePoints } from \"./utils/getAxesSpritePoints\";\nimport { prepareAnimationData } from \"./utils/prepareAnimationData\";\nimport { setRadius } from \"./utils/setRadius\";\nimport { updateSpritesOpacity } from \"./utils/updateSpritesOpacity\";\nimport { isClick } from \"./utils/isClick\";\nimport { resetSprites } from \"./utils/resetSprites\";\nimport { getIntersectionObject } from \"./utils/getIntersectionObject\";\nimport { clamp } from \"./utils/clamp\";\n\nimport { GizmoOptions, ViewportGizmoEventMap } from \"./types\";\nimport { GIZMO_AXES, GIZMO_DEFAULT_OPTIONS } from \"./utils/constants\";\n\nexport const targetPosition = new Vector3();\nexport const targetQuaternion = new Quaternion();\nexport const q1 = new Quaternion();\nexport const q2 = new Quaternion();\nexport const raycaster = new Raycaster();\n\nconst clock = new Clock();\nconst euler = new Euler();\nconst turnRate = 2 * Math.PI; // turn rate in angles per second\n\nconst mouseStart = new Vector2();\nconst mouseAngle = new Vector2();\nconst radius = { value: 0 };\nlet offsetHeight = 0;\n\nexport class ViewportGizmo extends Object3D<ViewportGizmoEventMap> {\n  private _backgroundSphere?: Mesh;\n  private _bgSphereOpacity: number = 0.2;\n  private _spritePoints: Sprite[];\n  private _container: HTMLElement;\n  private _domRect: DOMRect;\n  private _viewport: Vector4 = new Vector4();\n  private _renderer: WebGLRenderer;\n  private _orthoCamera = new OrthographicCamera(-1.8, 1.8, 1.8, -1.8, 0, 4);\n  private _domElement: HTMLElement;\n  private _parentRect: DOMRect | undefined;\n  enabled: boolean = true;\n  camera: OrthographicCamera | PerspectiveCamera;\n  animated: boolean = true;\n  animating = false;\n  target = new Vector3();\n  dragging: boolean = false;\n  size: number;\n  speed: number = 1;\n\n  constructor(\n    camera: PerspectiveCamera | OrthographicCamera,\n    renderer: WebGLRenderer,\n    options?: GizmoOptions\n  ) {\n    super();\n\n    this._renderer = renderer;\n    this._container = renderer.domElement;\n    this.camera = camera;\n\n    this._orthoCamera.position.set(0, 0, 2);\n\n    options = Object.assign(GIZMO_DEFAULT_OPTIONS, options || {});\n\n    const { container, placement, size, offset, backgroundSphere } =\n      options as Required<GizmoOptions>;\n\n    this.size = size;\n\n    const axesLines = getAxesLines(options);\n    this._spritePoints = getAxesSpritePoints(options);\n\n    this.add(axesLines, ...this._spritePoints);\n\n    if (backgroundSphere.enabled) {\n      this._backgroundSphere = getBackgroundSphere(backgroundSphere.color!);\n      this._bgSphereOpacity = backgroundSphere.opacity ?? 0.2;\n      this.add(this._backgroundSphere);\n    }\n\n    this._domElement = getDomContainer(placement, size, offset);\n    getDomElement(container).appendChild(this._domElement);\n\n    this._domRect = this._domElement.getBoundingClientRect();\n    this._parentRect = this._domElement.parentElement?.getBoundingClientRect();\n    this._startListening();\n\n    this.update();\n  }\n\n  render() {\n    if (this.animating) this._animate();\n\n    let x = this._domRect.left;\n    let y = offsetHeight - this._domRect.bottom;\n    if (this._parentRect) {\n      x -= this._parentRect.left;\n      y += this._parentRect.top;\n    }\n\n\n    const autoClear = this._renderer.autoClear;\n    this._renderer.autoClear = false;\n    this._renderer.setViewport(x, y, this.size, this.size);\n    this._renderer.clear(false, true, false);\n    this._renderer.render(this, this._orthoCamera);\n    this._renderer.setViewport(this._viewport);\n    this._renderer.autoClear = autoClear;\n  }\n\n  update() {\n    this._domRect = this._domElement.getBoundingClientRect();\n    offsetHeight = this._container.offsetHeight;\n    setRadius(this.camera, radius, this.target);\n    this._renderer.getViewport(this._viewport);\n\n    this._updateOrientation();\n  }\n\n  dispose() {\n    this.children.forEach((child) => {\n      const mesh = child as Mesh<any, MeshBasicMaterial>;\n      mesh.material?.dispose();\n      mesh.material?.map?.dispose();\n      mesh.geometry?.dispose();\n    });\n\n    this._domElement.remove();\n  }\n\n  // INTERNALS ↓↓↓\n  private _updateOrientation(fromCamera: boolean = true) {\n    if (fromCamera) {\n      this.quaternion.copy(this.camera.quaternion).invert();\n      this.updateMatrixWorld();\n    }\n\n    updateSpritesOpacity(this._spritePoints, this.camera);\n  }\n\n  private _animate() {\n    if (!this.animated) {\n      this.camera.quaternion.copy(targetQuaternion);\n      this.animating = false;\n      this.dispatchEvent({ type: \"change\" });\n      this.dispatchEvent({ type: \"end\" });\n      return;\n    }\n\n    const delta = clock.getDelta();\n\n    const step = delta * turnRate * this.speed;\n\n    q1.rotateTowards(q2, step);\n    this.camera.position\n      .set(0, 0, 1)\n      .applyQuaternion(q1)\n      .multiplyScalar(radius.value)\n      .add(this.target);\n\n    this.camera.quaternion.rotateTowards(targetQuaternion, step);\n\n    this._updateOrientation();\n    requestAnimationFrame(() => this.dispatchEvent({ type: \"change\" }));\n\n    if (q1.angleTo(q2) === 0) {\n      this.animating = false;\n      this.dispatchEvent({ type: \"end\" });\n    }\n  }\n\n  private _setOrientation(orientation: (typeof GIZMO_AXES)[number]) {\n    prepareAnimationData(this.camera, this.target, orientation, radius);\n    this.animating = true;\n    clock.start();\n    this.dispatchEvent({ type: \"start\" });\n  }\n\n  private _startListening() {\n    this._domElement.onpointerdown = (e) => this._onPointerDown(e);\n    this._domElement.onpointermove = (e) => this._onPointerMove(e);\n    this._domElement.onpointerleave = () => this._onPointerLeave();\n  }\n\n  private _onPointerDown(e: PointerEvent) {\n    if (!this.enabled) return;\n\n    const drag = (e: PointerEvent) => {\n      if (!this.dragging && isClick(e, mouseStart)) return;\n      if (!this.dragging) {\n        resetSprites(this._spritePoints);\n        this.dragging = true;\n      }\n\n      mouseAngle\n        .set(e.clientX, e.clientY)\n        .sub(mouseStart)\n        .multiplyScalar((1 / this._domRect.width) * Math.PI);\n\n      this.rotation.x = clamp(\n        rotationStart.x + mouseAngle.y,\n        Math.PI / -2 + 0.001,\n        Math.PI / 2 - 0.001\n      );\n      this.rotation.y = rotationStart.y + mouseAngle.x;\n      this.updateMatrixWorld();\n\n      q1.copy(this.quaternion).invert();\n\n      this.camera.position\n        .set(0, 0, 1)\n        .applyQuaternion(q1)\n        .multiplyScalar(radius.value)\n        .add(this.target);\n\n      this.camera.rotation.setFromQuaternion(q1);\n\n      this._updateOrientation(false);\n\n      this.dispatchEvent({ type: \"change\" });\n    };\n    const endDrag = () => {\n      document.removeEventListener(\"pointermove\", drag, false);\n      document.removeEventListener(\"pointerup\", endDrag, false);\n\n      if (!this.dragging) return this._handleClick(e);\n\n      this.dragging = false;\n      this.dispatchEvent({ type: \"end\" });\n    };\n\n    if (this.animating === true) return;\n    e.preventDefault();\n\n    mouseStart.set(e.clientX, e.clientY);\n\n    const rotationStart = euler.copy(this.rotation);\n\n    setRadius(this.camera, radius, this.target);\n\n    document.addEventListener(\"pointermove\", drag, false);\n    document.addEventListener(\"pointerup\", endDrag, false);\n\n    this.dispatchEvent({ type: \"start\" });\n  }\n\n  private _onPointerMove(e: PointerEvent) {\n    if (!this.enabled || this.dragging) return;\n\n    if (this._backgroundSphere)\n      (this._backgroundSphere.material as Material).opacity =\n        this._bgSphereOpacity;\n\n    this._handleHover(e);\n  }\n\n  private _onPointerLeave() {\n    if (!this.enabled || this.dragging) return;\n\n    if (this._backgroundSphere)\n      (this._backgroundSphere.material as Material).opacity = 0;\n\n    resetSprites(this._spritePoints);\n    this._domElement.style.cursor = \"\";\n  }\n\n  private _handleClick(e: PointerEvent) {\n    const object = getIntersectionObject(\n      e,\n      this._domRect,\n      this._orthoCamera,\n      this._spritePoints\n    );\n\n    if (!object) return;\n\n    this._setOrientation(object.userData.type);\n    this.dispatchEvent({ type: \"change\" });\n  }\n\n  private _handleHover(e: PointerEvent) {\n    const object = getIntersectionObject(\n      e,\n      this._domRect,\n      this._orthoCamera,\n      this._spritePoints\n    );\n\n    resetSprites(this._spritePoints);\n\n    if (!object) {\n      this._domElement.style.cursor = \"\";\n    } else {\n      object.material.map!.offset.x = 0.5;\n      object.scale.multiplyScalar(1.2);\n      this._domElement.style.cursor = \"pointer\";\n    }\n  }\n}\n"],"names":["getDomContainer","placement","size","offset","div","style","top","left","right","bottom","y","x","GIZMO_AXES","GIZMO_DEFAULT_OPTIONS","COLOR_MANAGER","Color","getAxesLines","options","positions","colors","key","i","axis","negative","distance","main","color1","color2","geometry","BufferGeometry","BufferAttribute","LineSegments","LineBasicMaterial","getDomElement","domElement","element","getBackgroundSphere","color","SphereGeometry","Mesh","MeshBasicMaterial","BackSide","getSpriteMaterial","font","resolution","text","textColor","hover","hoverText","border","canvas","radius","centerY","circle2X","context","drawCircle","family","weight","fixY","fitTextInBox","texture","CanvasTexture","SRGBColorSpace","RepeatWrapping","SpriteMaterial","borderSize","ctx","square","fontSize","textWidth","textHeight","measure","scaleFactor","finalFontSize","getAxesSpritePoints","spriteResolution","isPositive","forceScale","sprite","Sprite","dummy","Object3D","prepareQuaternions","camera","focusPoint","targetPosition","q1","q2","setRadius","prepareAnimationData","targetQuaternion","Euler","point","Vector3","updateSpritesOpacity","sprites","isClick","e","startCoords","threshold","resetSprites","mouse","Vector2","updatePointer","domRect","orthoCamera","raycaster","getIntersectionObject","event","intersectionObjects","intersects","clamp","num","min","max","Quaternion","Raycaster","clock","Clock","euler","turnRate","mouseStart","mouseAngle","offsetHeight","ViewportGizmo","renderer","__publicField","Vector4","OrthographicCamera","container","backgroundSphere","axesLines","_a","autoClear","child","mesh","_c","_b","_d","fromCamera","step","orientation","drag","rotationStart","endDrag","object"],"mappings":"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"}